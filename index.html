<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LCB ID Translations</title>
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
  <link rel="stylesheet" href="style.css">
  <link rel="preload" href="assets/mouse_on.cur" as="image">
  <link rel="preload" href="assets/UI_Hover.wav" as="audio">
  <link rel="preload" href="assets/UI_Click.wav" as="audio">
  <link rel="preload" href="assets/Yi_Sang/LCB_YiSang.png" as="image">
  <link rel="preload" href="assets/Faust/LCB_Faust.png" as="image">
  <link rel="preload" href="assets/Don_Quixote/LCB_DonQ.png" as="image">
  <link rel="preload" href="assets/Ryōshū/LCB_Ryōshū.png" as="image">
  <link rel="preload" href="assets/Meursault/LCB_Meursault.png" as="image">
  <link rel="preload" href="assets/Hong_Lu/LCB_Hong_Lu.png" as="image">
  <link rel="preload" href="assets/Heathcliff/LCB_Heathcliff.png" as="image">
  <link rel="preload" href="assets/Ishmael/LCB_Ishmael.png" as="image">
  <link rel="preload" href="assets/Rodion/LCB_Rodion.png" as="image">
  <link rel="preload" href="assets/Sinclair/LCB_Sinclair.png" as="image">
  <link rel="preload" href="assets/Outis/LCB_Outis.png" as="image">
  <link rel="preload" href="assets/Gregor/LCB_Gregor.png" as="image">
  <link rel="preload" href="assets/background.png" as="image">
  <link rel="preload" href="assets/Yi_Sang/LCB_YiSang.png" as="image">
  <link rel="preload" href="assets/Faust/LCB_Faust.png" as="image">
  <link rel="preload" href="assets/Don_Quixote/LCB_DonQ.png" as="image">
  <link rel="preload" href="pages/Yi_Sang.html" as="document">
  <link rel="preload" href="pages/Faust.html" as="document">
  <link rel="preload" href="pages/Don_Quixote.html" as="document">
  <link rel="preload" href="pages/Ryōshū.html" as="document">
  <link rel="preload" href="pages/Meursault.html" as="document">
  <link rel="preload" href="pages/Hong_Lu.html" as="document">
  <link rel="preload" href="pages/Heathcliff.html" as="document">
  <link rel="preload" href="pages/Ishmael.html" as="document">
  <link rel="preload" href="pages/Rodion.html" as="document">
  <link rel="preload" href="pages/Sinclair.html" as="document">
  <link rel="preload" href="pages/Outis.html" as="document">
  <link rel="preload" href="pages/Gregor.html" as="document">  
</head>
<body>

<div class="bg-container">
  <div class="body-bg" id="current-bg"></div>
  <div class="body-bg" id="new-bg"></div>
</div>

<a href="https://www.youtube.com/@NotherWael" target="_blank">
  <img src="assets/channels4_profile.jpg" alt="YouTube Profile" id="youtube-profile">
</a>

<!-- Back Button -->
<button id="back-button" style="display:none;">
  <img src="assets/Back.png" alt="Back" />
</button>

<div class="overlay">
  <div class="content mikodacs-text">
    <h1>LCB Identities - Untranslated Voicelines Translated to English & Unused Voicelines</h1>
    <p>Updated Sept 14th 2025 (N Corp. E.G.O::Contempt, Awe Ryōshū Added!) - Translations are Unofficial and can be wrong at times...<br>Bad Internet May Cause The Site to Load Really Slow... (Translated by NotherWael)</p>

    <!-- Main Image Gallery -->
    <div class="image-gallery">
      <a href="pages/Yi_Sang.html" data-background="assets/Yi_Sang/LCB_YiSang.png">
        <img src="assets/Yi_Sang.png" alt="Yi Sang">
      </a>
      <a href="pages/Faust.html" data-background="assets/Faust/LCB_Faust.png">
        <img src="assets/Faust.png" alt="Faust">
      </a>
      <a href="pages/Don_Quixote.html" data-background="assets/Don_Quixote/LCB_DonQ.png">
        <img src="assets/Don_Quixote.png" alt="Don Quixote">
      </a>
      <a href="pages/Ryōshū.html" data-background="assets/Ryōshū/LCB_Ryōshū.png">
        <img src="assets/Ryōshū.png" alt="Ryōshū">
      </a>
      <a href="pages/Meursault.html" data-background="assets/Meursault/LCB_Meursault.png">
        <img src="assets/Meursault.png" alt="Meursault">
      </a>
      <a href="pages/Hong_Lu.html" data-background="assets/Hong_Lu/LCB_Hong_Lu.png">
        <img src="assets/Hong_Lu.png" alt="Hong Lu">
      </a>
      <a href="pages/Heathcliff.html" data-background="assets/Heathcliff/LCB_Heathcliff.png">
        <img src="assets/Heathcliff.png" alt="Heathcliff">
      </a>
      <a href="pages/Ishmael.html" data-background="assets/Ishmael/LCB_Ishmael.png">
        <img src="assets/Ishmael.png" alt="Ishmael">
      </a>
      <a href="pages/Rodion.html" data-background="assets/Rodion/LCB_Rodion.png">
        <img src="assets/Rodion.png" alt="Rodion">
      </a>
      <a href="pages/Sinclair.html" data-background="assets/Sinclair/LCB_Sinclair.png">
        <img src="assets/Sinclair.png" alt="Sinclair">
      </a>
      <a href="pages/Outis.html" data-background="assets/Outis/LCB_Outis.png">
        <img src="assets/Outis.png" alt="Outis">
      </a>
      <a href="pages/Gregor.html" data-background="assets/Gregor/LCB_Gregor.png">
        <img src="assets/Gregor.png" alt="Gregor">
      </a>
    </div>

    <!-- Dynamic content -->
    <div id="dynamic-content" class="dynamic-content"></div>
  </div>
</div>

<!-- Sounds -->
<audio src="assets/UI_Hover.wav" preload="auto" style="display:none;"></audio>
<audio src="assets/UI_Click.wav" preload="auto" style="display:none;"></audio>

<script>
  const hoverSoundTemplate = new Audio('assets/UI_Hover.wav');
  hoverSoundTemplate.volume = 0.7;
  const clickSound = new Audio('assets/UI_Click.wav');
  clickSound.volume = 0.8;
  let canClickPlay = true;
  const cache = new Map();
  let currentCharacterGallery = null;
  let backButtonHandler = null;

  const gallery = document.querySelector('.image-gallery');
  const galleryLinks = document.querySelectorAll('.image-gallery a');
  const dynamicContent = document.getElementById('dynamic-content');
  const backButton = document.getElementById('back-button');

  // Hover sounds for back button
  backButton.addEventListener('mouseenter', () => {
    const hoverSound = hoverSoundTemplate.cloneNode();
    hoverSound.play().catch((e) => {
      console.warn("Hover sound failed to play:", e);
    });
  });

  // Main gallery hover sounds
galleryLinks.forEach(link => {
  const img = link.querySelector('img');
  
  // Hover sound handler
  img.addEventListener('mouseenter', () => {
    const hoverSound = hoverSoundTemplate.cloneNode();
    hoverSound.play().catch(() => {});
  });

  // Click handler
  img.addEventListener('click', (e) => {
    e.preventDefault();
    
    // Play click sound
    if (canClickPlay) {
      clickSound.currentTime = 0;
      clickSound.play().catch(() => {});
      canClickPlay = false;
      setTimeout(() => { canClickPlay = true; }, 300);
    }

    // Change background
    const bgImage = link.dataset.background;
    if (bgImage) changeBackground(bgImage);

    // Handle content loading
    const targetUrl = link.getAttribute('href');
    if (cache.has(targetUrl)) {
      showContent(cache.get(targetUrl));
    } else {
      fetch(targetUrl)
        .then(response => response.text())
        .then(html => {
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const content = doc.body.innerHTML;
          cache.set(targetUrl, content);
          showContent(content);
        })
        .catch(err => {
          dynamicContent.innerHTML = "<p>Error loading content.</p>";
          console.error(err);
        });
    }
  });
});

  let currentBg = document.getElementById('current-bg');
  let newBg = document.getElementById('new-bg');

async function preloadAllGalleryAssets() {
  // Preload main gallery images
  document.querySelectorAll('.image-gallery a, .character-gallery a').forEach(link => {
    const bgLoader = new Image();
    bgLoader.src = link.dataset.background;
    
    const imgLoader = new Image();
    imgLoader.src = link.querySelector('img').src;
  });
  
  const backgroundImages = [
    'assets/Yi_Sang/LCB_YiSang.png',
    'assets/Faust/LCB_Faust.png',
    'assets/Don_Quixote/LCB_DonQ.png',
	'assets/Meursault/LCB_Meursault.png',
	'assets/Hong_Lu/LCB_Hong_Lu.png',
	'assets/Heathcliff/LCB_Heathcliff.png',
	'assets/Ishmael/LCB_Ishmael.png',
	'assets/Rodion/LCB_Rodion.png',
	'assets/Sinclair/LCB_Sinclair.png',
	'assets/Outis/LCB_Outis.png',
	'assets/Gregor/LCB_Gregor.png',
  ];
  
  const characterPages = [
    'pages/Yi_Sang.html',
    'pages/Faust.html',
    'pages/Don_Quixote.html',
	'pages/Ryōshū.html',
	'pages/Meursault.html',
	'pages/Hong_Lu.html',
	'pages/Heathcliff.html',
	'pages/Ishmael.html',
	'pages/Rodion.html',
	'pages/Sinclair.html',
	'pages/Outis.html',
	'pages/Gregor.html',
  ];
  
  await Promise.all(characterPages.map(async (page) => {
    try {
      const response = await fetch(page);
      const html = await response.text();
      cache.set(page, html); // Store HTML in cache
      
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');
      
      // Preload images from character pages
      doc.querySelectorAll('.character-voice').forEach(link => {
        new Image().src = link.dataset.background;
        new Image().src = link.querySelector('img').src;
      });
    } catch (error) {
      console.error('Preload failed for:', page, error);
    }
  }));
}

  function preloadCharacterBackgrounds() {
    document.querySelectorAll('[data-background]').forEach(link => {
      const img = new Image();
      img.src = link.dataset.background;
    });
  }
  
function preloadCriticalAssets() {
  // Preload character gallery background images immediately
  const criticalImages = [
    'assets/Yi_Sang.png',
    'assets/Faust.png',
    'assets/Don_Quixote.png',
    'assets/Ryōshū.png',
	'assets/Meursault.png',
	'assets/Hong_Lu.png',
	'assets/Heathcliff.png',
	'assets/Ishmael.png',
	'assets/Rodion.png',
	'assets/Sinclair.png',
	'assets/Outis.png',
	'assets/Gregor.png',
  ];
  
  criticalImages.forEach(src => {
    const img = new Image();
    img.src = src;
  });
}

document.addEventListener('DOMContentLoaded', () => {
  preloadCriticalAssets();
  preloadCharacterBackgrounds();
  preloadAllGalleryAssets();
});

  async function changeBackground(bgUrl) {
    const currentBg = document.getElementById('current-bg');
    currentBg.style.backgroundImage = `url(${bgUrl})`;
  }

  galleryLinks.forEach(link => {
    const img = link.querySelector('img');
    img.addEventListener('click', (e) => {
      e.preventDefault();
      if (canClickPlay) {
        clickSound.currentTime = 0;
        clickSound.play().catch(() => {});
        canClickPlay = false;
        setTimeout(() => { canClickPlay = true; }, 300);
      }

      const bgImage = link.dataset.background;
      if (bgImage) changeBackground(bgImage);

      const targetUrl = link.getAttribute('href');
      if (cache.has(targetUrl)) {
        showContent(cache.get(targetUrl));
      } else {
        fetch(targetUrl)
          .then(response => response.text())
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const content = doc.body.innerHTML;
            cache.set(targetUrl, content);
            showContent(content);
          })
          .catch(err => {
            dynamicContent.innerHTML = "<p>Error loading content.</p>";
            console.error(err);
          });
      }
    });
  });
  
  dynamicContent.addEventListener('mouseenter', (e) => {
  const galleryImg = e.target.closest('.character-gallery img');
  if (galleryImg) {
    const hoverSound = hoverSoundTemplate.cloneNode();
    hoverSound.play().catch(() => {});
  }
}, true); // Use capture phase for dynamic content

  dynamicContent.addEventListener('click', (e) => {
  const galleryImg = e.target.closest('.character-gallery img');
  const bgLink = e.target.closest('[data-background]');
  
  if (bgLink) changeBackground(bgLink.dataset.background);
  
  if (galleryImg) {
    e.preventDefault();
    if (canClickPlay) {
      clickSound.currentTime = 0;
      clickSound.play().catch(() => {});
      canClickPlay = false;
      setTimeout(() => { canClickPlay = true; }, 300);
    }
    showVoicelineDetail(galleryImg);
  }
});

function showVoicelineDetail(imgElement) {
  const parentLink = imgElement.closest('.character-voice');
  const pageClass = parentLink.dataset.page || '';
  const charTitle = parentLink.dataset.characterTitle || "Character Name";
  const charIcon = parentLink.dataset.characterIcon || "default_icon.png";
  
  const translationLink = parentLink.dataset.translationLink || '#'; 

  const voicelines = (parentLink.dataset.voiceline || "").split('|').map(v => v.trim());
  const translations = (parentLink.dataset.translation || "").split('|').map(v => v.trim());
  const audios = (parentLink.dataset.audio || "").split('|').map(v => v.trim());
  const notes = (parentLink.dataset.notes || "").split('|').map(v => v.trim());

  let rows = [];
  for (let i = 0; i < translations.length; i++) {
    const audioEntry = audios[i] || '';
    const [mainSection, unusedSection] = audioEntry.split(';').map(s => s.trim());
    
    // Process main audio
    const mainAudio = mainSection.split(',').filter(url => url.trim());
    const mainElements = mainAudio.map(url => 
      `<audio controls class="audio-stack"><source src="${url}"></audio>`
    ).join('');

    // Process unused audio
    const unusedAudio = unusedSection ? unusedSection.split(',').filter(url => url.trim()) : [];
    const unusedElements = unusedAudio.map(url => 
      `<audio controls class="audio-stack unused"><source src="${url}"></audio>`
    ).join('');

    // Build audio column
    let audioColumn = '—';
    if (mainElements || unusedElements) {
      audioColumn = `
        ${mainElements}
        ${unusedElements ? `<div class="unused-section">UNUSED:${unusedElements}</div>` : ''}
      `;
    }

    rows.push(`
      <tr>
        <td>${voicelines[i] || '—'}</td>
        <td>${translations[i] || '—'}</td>
        <td>${audioColumn}</td>
        <td>${notes[i] || '—'}</td>
      </tr>
    `);
  }

  const detailHTML = `
    <div class="voiceline-detail ${pageClass}">
	  <a href="${translationLink}" class="translation-link" target="_blank">
        Link to Already Translated Voicelines
      </a>
      <div class="detail-header">
        <img src="${charIcon}" alt="${charTitle} Icon">
        <h2>${charTitle}</h2>
      </div>
      <img src="${imgElement.src}" alt="${imgElement.alt}" class="detail-image">
      <div class="spreadsheet">
        <table>
          <thead>
            <tr>
              <th>Voiceline</th>
              <th>Translation</th>
              <th>Audio</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${rows.join('')}
          </tbody>
        </table>
      </div>
    </div>
  `;
  dynamicContent.innerHTML = detailHTML;
  backButtonHandler = returnToCharacterGallery;
}

  function returnToCharacterGallery() {
    dynamicContent.innerHTML = currentCharacterGallery;
    backButtonHandler = returnToMainGallery;
  }

  function returnToMainGallery() {
    dynamicContent.innerHTML = '';
    dynamicContent.classList.remove('visible');
    gallery.style.display = 'grid';
    backButton.style.display = 'none';
    document.getElementById('current-bg').style.backgroundImage = "url('assets/background.png')";
  }

  backButton.addEventListener('click', () => {
    clickSound.currentTime = 0;
    clickSound.play().catch(console.warn);
    backButtonHandler ? backButtonHandler() : returnToMainGallery();
  });

  function showContent(html) {
    gallery.style.display = 'none';
    dynamicContent.innerHTML = html;
    dynamicContent.classList.add('visible');
    backButton.style.display = 'block';
    preloadAllGalleryAssets();
    
    const characterGallery = dynamicContent.querySelector('.character-gallery');
    if (characterGallery) {
      currentCharacterGallery = dynamicContent.innerHTML;
      backButtonHandler = returnToMainGallery;
    }
  }
</script>
<!-- Background Music -->
<audio id="bg-music" autoplay loop hidden>
  <source src="assets/Main Menu Theme.wav" type="audio/mpeg">
</audio>

<!-- Music Toggle Button -->
<button id="music-toggle">
  <img src="assets/music_on.png" alt="Music On" />
</button>

<script>
  const bgMusic = document.getElementById('bg-music');
  const musicToggle = document.getElementById('music-toggle');

  // default volume
  bgMusic.volume = 0.4;

  // If autoplay is blocked, start after first click
  document.addEventListener('click', () => {
    if (bgMusic.paused) {
      bgMusic.play().catch(err => console.warn("Music autoplay blocked:", err));
    }
  }, { once: true });

  // Toggle button logic
  let musicOn = true;
  musicToggle.addEventListener('click', () => {
    if (musicOn) {
      bgMusic.pause();
      musicToggle.querySelector('img').src = "assets/music_off.png";
      musicToggle.querySelector('img').alt = "Music Off";
    } else {
      bgMusic.play().catch(() => {});
      musicToggle.querySelector('img').src = "assets/music_on.png";
      musicToggle.querySelector('img').alt = "Music On";
    }
    musicOn = !musicOn;
  });
</script>

<style>
  #music-toggle {
    position: fixed;
    top: 100px;
    right: 24px;
    background: none;
    border: none;
    cursor: pointer;
    z-index: 2000;
  }

  #music-toggle img {
    width: 40px;
    height: 40px;
  }
</style>

</body>
</html>